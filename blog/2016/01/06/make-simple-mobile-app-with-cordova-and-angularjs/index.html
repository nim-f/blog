
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Как сделать простое мобильное приложение с помощью Apache Cordova и AngularJS - Заметки о фронтэнде</title>
  <meta name="author" content="Ann R">

  
  <meta name="description" content="Все мои планы на долгие рождественские выходные полетели коту под хвост из-за погоды. Сначала снег, а я на летней резине. Потом оттепель, гололед, &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://nim-f.github.io/blog/2016/01/06/make-simple-mobile-app-with-cordova-and-angularjs/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Заметки о фронтэнде" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-71875764-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <nav role="navigation">
<ul class="main-navigation">
  <li class="left_side logo"><a href="/"><span clas="bike">C</span> reinvent the wheel</a></li>
  <li class="right_side"><a href="/">Блог</a></li>
  <li class="right_side"><a href="/blog/archives">Архив</a></li>
  <li class="right_side"><a href="/about">Обо мне</a></li>

</ul>

</nav>
  <header role="banner"><hgroup>
  

  

</hgroup>

<ul class="tags_list">
  <li><a href='/blog/categories/android'>android (1)</a></li><li><a href='/blog/categories/angularjs'>angularjs (1)</a></li><li><a href='/blog/categories/bugs'>bugs (1)</a></li><li><a href='/blog/categories/chrome'>chrome (1)</a></li><li><a href='/blog/categories/cordova'>cordova (1)</a></li><li><a href='/blog/categories/css'>css (1)</a></li><li><a href='/blog/categories/frontend'>frontend (1)</a></li><li><a href='/blog/categories/mobile'>mobile (1)</a></li><li><a href='/blog/categories/nodejs'>nodejs (1)</a></li><li><a href='/blog/categories/octopress'>octopress (1)</a></li><li><a href='/blog/categories/webkit'>webkit (1)</a></li>
</ul>
</header>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Как сделать простое мобильное приложение с помощью Apache Cordova и AngularJS</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-01-06T10:50:21+02:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>6</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>10:50 am</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Все мои планы на долгие рождественские выходные полетели коту под хвост из-за погоды. Сначала снег, а я на летней резине. Потом оттепель, гололед, лужи, дождь, туман, все разом - от одного взгляда за окно хочется еще глубже залезть под одеяло. Вместо того, чтобы слоняться по дому в тоске, я решила попробовать то, чего никогда не делала - написать мобильное приложение и поставить его на свой android-смартфон. А в случае успеха написать небольшой гайд для таких же новичков, как я.</p>




<p>Cordova - это open-sourse проект, позволяющий создавать программы для мобильных устройств, используя стандартные инструменты веб-разработчика: HTML, CSS и Javascript. По сути, мы просто пишем сайт, а потом запускаем в консоли волшебную команду, и она превращает его в приложение для выбранных платформ. Документация в подробностях здесь - <a href="https://cordova.apache.org" target="_blank">www.cordova.apache.org</a>, и я постараюсь ее не пересказывать, а сосредоточиться  на руководстве к действию.</p>




<!-- more -->




<p>Вот что должно получиться в результате:</p>


<p><img src="/images/listimg.png" alt="shopList app" /></p>

<p>Я решила сделать простую программку для ведения списков - будь то список продуктов для похода в магазин или to-do list, потому что все имеющиеся в google play бесплатные программы угнетают меня своим дизайном или обилием ненужных функций.</p>




<p>Описание установки рабочего окружение актуально для OS X и других unix систем, но не думаю, что на Windows порядок действий будет радикально отличаться.</p>




<p>Итак, предположим, что Node.js и git у Вас уже установлены. Ставим Cordova:</p>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>npm install -g cordova</span></code></pre></td></tr></table></div></figure>


<p>Затем, чтобы запускать эмулятор и делать билд приложения, нужно установить всю требуху для выбранной платформы - iOS, android, windows или еще какой-нибудь. Полный список поддерживаемых платформ и фич <a href="https://cordova.apache.org/docs/en/latest/guide/support/index.html" target="_blank">все там же</a></p>




<p>Моя цель - android, поэтому поставить пришлось следующее:</p>




<ul>
<li>Java</li>
<li>Java SE Development Kit</li>
<li>Android SDK</li>
</ul>




<p>Теперь можно создавать проект, точно так же, как описано в официальной документации:</p>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cordova create hello com.example.hello HelloWorld
</span><span class='line'>cd hello
</span><span class='line'>cordova platform add android
</span><span class='line'>cordova platform add browser
</span></code></pre></td></tr></table></div></figure>




<p>И запускаем билд.</p>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cordova build</span></code></pre></td></tr></table></div></figure>




<p>Если все пройдет гладко, вы увидите в терминале многабукаф и надпись "BUILD SUCCESSFUL" в самом конце.</p>




<p>Я, помимо андроида, добавила в список платформ браузер, потому что для меня отлаживать разметку и css так гораздо удобнее, чем каждый раз перезапускать эмулятор или ставить новую версию приложения на физическое устройство.</p>




<p>Кстати, чуть не забыла - если до этого Вы не запускали андроид-эмулятор, то нужно будет его создать, но это просто, сообщение об ошибке в командной строке подскажет вам, как.</p>




<p>Запускаем только что созданный шаблон приложения в эмуляторе:</p>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cordova emulate android</span></code></pre></td></tr></table></div></figure>




<p>Или в браузере:</p>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cordova run browser</span></code></pre></td></tr></table></div></figure>


<p>Или устанавливаем и запускаем на живом устройстве:</p>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cordova run android</span></code></pre></td></tr></table></div></figure>




<p>Перед нами дефолтная болванка программы с логотипом Кордовы и надписью "device is ready". Все дальнейшие изменения нужно производить в каталоге www. При запуске любой из указанных выше трех команд или </p>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cordova build</span></code></pre></td></tr></table></div></figure>




<p>Cordova сама сгенерирует нам правильный код и сложит его в папку platforms, в которой мы пока что ничего не трогаем.</p>




<p>Чтобы сделать задачу более интересной, я решила использовать AngularJS. Этот фреймворк сейчас в моде, значит надо попробовать и понять, почему все так любят его, а не какой-нибудь Backbone.js.</p>




<p>В этом случае нам здорово облегчит жизнь <a href="http://ngcordova.com/" target="_blank">ngCordova</a>. Это прослойка между angular и плагинами cordova, предоставляющая тонну возможностей в минимуме кода.</p>




<p>Открываем index.html в папке www и подключаем скрипты:</p>




<figure class='code'><figcaption><span>index.html</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>    <span class="c">&lt;!-- собственно ангуляр --&gt;</span>
</span><span class='line'>    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;js/angular.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'>    <span class="c">&lt;!-- библиотека для событий touch и swipe на сенсорных девайсах --&gt;</span>
</span><span class='line'>    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;js/angular-touch.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'>    <span class="c">&lt;!-- ngCordova должна быть подключена после ангуляра, но до самой Cordova--&gt;</span>
</span><span class='line'>    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;js/ng-cordova.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'>    <span class="c">&lt;!-- Cordova.js был по дефолту --&gt;</span>
</span><span class='line'>    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;cordova.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'>    <span class="c">&lt;!-- файл контроллера для нашего приложения --&gt;</span>
</span><span class='line'>    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;js/controllers.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'>    <span class="c">&lt;!-- дефолтный index.js - предлагаю его пока не удалять, а просто закомментить его содержимое, мало ли, вдруг пригодится --&gt;</span>
</span><span class='line'>    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;js/index.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<p>Дальше самое простое - разметка. Нам нужен заголовок, список и текстовое поле с кнопкой. Да здравствует минимализм! </p>




<figure class='code'><figcaption><span>index.html</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;app&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;h1&gt;</span>Shop List<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>        <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">&quot;list&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>            <span class="nt">&lt;li&gt;</span>
</span><span class='line'>                //тут будет содержимое списка
</span><span class='line'>            <span class="nt">&lt;/li&gt;</span>
</span><span class='line'>            <span class="nt">&lt;li</span> <span class="na">ng-bind=</span><span class="s">&quot;new_item&quot;</span> <span class="na">ng-show=</span><span class="s">&quot;new_item&quot;</span><span class="nt">&gt;&lt;/li&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/ul&gt;</span>
</span><span class='line'>        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;add-item&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;button&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>Add<span class="nt">&lt;/div&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<p>Теперь очередь контроллера. Записываем в него массив с нашим списком покупок (пока что статично) и функцию добавления нового элемента в список.</p>




<figure class='code'><figcaption><span>controllers.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">shopList</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;shopList&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ngCordova&#39;</span><span class="p">,</span> <span class="s1">&#39;ngTouch&#39;</span><span class="p">]);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">shopList</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;ItemsListCtrl&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">$scope</span><span class="p">.</span><span class="nx">items</span> <span class="o">=</span> <span class="p">[</span>
</span><span class='line'>      <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Bread&quot;</span><span class="p">,</span> <span class="s2">&quot;qty&quot;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="s2">&quot;priority&quot;</span><span class="o">:</span> <span class="mi">0</span><span class="p">},</span>
</span><span class='line'>      <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Fruits&quot;</span><span class="p">,</span> <span class="s2">&quot;qty&quot;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="s2">&quot;priority&quot;</span><span class="o">:</span> <span class="mi">0</span><span class="p">},</span>
</span><span class='line'>      <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Water&quot;</span><span class="p">,</span> <span class="s2">&quot;qty&quot;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="s2">&quot;priority&quot;</span><span class="o">:</span> <span class="mi">0</span><span class="p">}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="p">];</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">$scope</span><span class="p">.</span><span class="nx">add</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">itemObj</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>            <span class="s1">&#39;name&#39;</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span>
</span><span class='line'>            <span class="s1">&#39;qty&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>            <span class="s1">&#39;status&#39;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span class='line'>            <span class="s1">&#39;priority&#39;</span><span class="o">:</span> <span class="mi">0</span>
</span><span class='line'>        <span class="p">};</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">items</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">$scope</span><span class="p">.</span><span class="nx">items</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">itemObj</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">$scope</span><span class="p">.</span><span class="nx">items</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class='line'>            <span class="nx">$scope</span><span class="p">.</span><span class="nx">items</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">itemObj</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">$scope</span><span class="p">.</span><span class="nx">new_item</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>




<p>Вносим соответствующие изменения в шаблон - добавляем контроллер к тегу body, ng-repeat из массива к li, привязываем к текстовому полю модель new_item, а к кнопке - функцию добавления новой записи.</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;body</span> <span class="na">ng-app=</span><span class="s">&quot;shopList&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;app&quot;</span> <span class="na">ng-controller=</span><span class="s">&quot;ItemsListCtrl&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;h1&gt;</span>Shop List<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>        <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">&quot;list&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>            <span class="nt">&lt;li</span> <span class="na">ng-repeat=</span><span class="s">&quot;item in items track by $index&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>                {{item.name}}
</span><span class='line'>            <span class="nt">&lt;/li&gt;</span>
</span><span class='line'>            <span class="nt">&lt;li</span> <span class="na">ng-bind=</span><span class="s">&quot;new_item&quot;</span> <span class="na">ng-show=</span><span class="s">&quot;new_item&quot;</span><span class="nt">&gt;&lt;/li&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/ul&gt;</span>
</span><span class='line'>        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;add-item&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;new_item&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;button&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="na">ng-click=</span><span class="s">&quot;add(new_item)&quot;</span><span class="nt">&gt;</span>Add<span class="nt">&lt;/div&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>   <span class="nt">&lt;/body&gt;</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>




<p>На css подробно останавливаться не буду. В конце статьи есть ссылка на репозиторий с кодом, можно использовать css-файл оттуда или написать самостоятельно.</p>




<p>Если сейчас вы запустите команду</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>cordova run browser
</span></code></pre></td></tr></table></div></figure>


<p>или </p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>cordova run android
</span></code></pre></td></tr></table></div></figure>


<p>то приложение будет работать - добавлять запись в список. Но если его перезапустить, новые данные не сохранятся. Поэтому надо записывать их в какое-нибудь постоянное хранилище. </p>




<p>Официальная документация предлагает несколько <a href="https://cordova.apache.org/docs/en/4.0.0/cordova/storage/storage.html" target="_blank">вариантов</a>. Я воспользуюсь двумя, которые мне кажутся самыми простыми - localStorage и запись в файл.</p>




<p>Для начала рассмотрим localStorage - это легче всего, не нужны никакие дополнительные плагины, просто сохраняем массив с объектами в строку и записываем. Нужно добавить следующий код в конец функции add:</p>




<figure class='code'><figcaption><span>controllers.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>        <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">items</span><span class="p">);</span>
</span><span class='line'>        <span class="c1">//Save to localStorage</span>
</span><span class='line'>        <span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>




<p>И в самое начало контроллера, вместо статичного массива:</p>




<figure class='code'><figcaption><span>controllers.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">shopList</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;ItemsListCtrl&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$cordovaFile</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">//Load from localStorage</span>
</span><span class='line'>    <span class="nx">$scope</span><span class="p">.</span><span class="nx">items</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">localStorage</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]);</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">...</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<p>Можно оставить так или же записывать наши данные в файл. Я выбираю второй вариант. Для него потребуется использовать модуль <a href="http://ngcordova.com/docs/plugins/file/" target="_blank">File</a> из ngCordova.</p>




<p>Удаляем (или комментируем) код про localStorage, и вместо него добавляем вот это:</p>




<figure class='code'><figcaption><span>controllers.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">shopList</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">&#39;ItemsListCtrl&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$cordovaFile</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>   <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;deviceready&quot;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">$scope</span><span class="p">.</span><span class="nx">listPath</span> <span class="o">=</span> <span class="nx">cordova</span><span class="p">.</span><span class="nx">file</span><span class="p">.</span><span class="nx">externalRootDirectory</span><span class="p">;</span>
</span><span class='line'>        <span class="c1">//Read from file</span>
</span><span class='line'>        <span class="nx">$cordovaFile</span><span class="p">.</span><span class="nx">readAsText</span><span class="p">(</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">listPath</span><span class="p">,</span> <span class="s2">&quot;list.json&quot;</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">$scope</span><span class="p">.</span><span class="nx">items</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
</span><span class='line'>        <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Error! &#39;</span> <span class="o">+</span> <span class="nx">err</span><span class="p">);</span>
</span><span class='line'>        <span class="p">});</span>
</span><span class='line'>    <span class="p">},</span> <span class="kc">false</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">...</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<p>Этот плагин будет читать информацию из файла и в случае успеха возвращать строку, которую необходимо сконвертировать в объект для дальнейшего использования, а в случае ошибки - выводить алерт с ее описанием. Но чтобы что-то прочитать, нужно сначала что-то записать! Добавляем функцию writeFile.</p>




<figure class='code'><figcaption><span>controllers.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="nx">$scope</span><span class="p">.</span><span class="nx">writeFile</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">items</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">$cordovaFile</span><span class="p">.</span><span class="nx">writeFile</span><span class="p">(</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">listPath</span><span class="p">,</span> <span class="s2">&quot;list.json&quot;</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="kc">true</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Error! &#39;</span> <span class="o">+</span> <span class="nx">err</span><span class="p">);</span>
</span><span class='line'>        <span class="p">});</span>
</span><span class='line'>    <span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>




<p>И используем ее в функции add вместо записи в localStorage:</p>




<figure class='code'><figcaption><span>controllers.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="nx">$scope</span><span class="p">.</span><span class="nx">add</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">itemObj</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>            <span class="s1">&#39;name&#39;</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span>
</span><span class='line'>            <span class="s1">&#39;qty&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>            <span class="s1">&#39;status&#39;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span class='line'>            <span class="s1">&#39;priority&#39;</span><span class="o">:</span> <span class="mi">0</span>
</span><span class='line'>        <span class="p">};</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">items</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">$scope</span><span class="p">.</span><span class="nx">items</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">itemObj</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">$scope</span><span class="p">.</span><span class="nx">items</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class='line'>            <span class="nx">$scope</span><span class="p">.</span><span class="nx">items</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">itemObj</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">$scope</span><span class="p">.</span><span class="nx">new_item</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">items</span><span class="p">);</span>
</span><span class='line'>        <span class="c1">//Save to file</span>
</span><span class='line'>        <span class="nx">$scope</span><span class="p">.</span><span class="nx">writeFile</span><span class="p">();</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>




<p>Вот и все, теперь все данные записаны в файле. Я записала их в externalRootDirectory, просто потому что мне так захотелось (а еще потому, что так при переустановке приложения во время разработки файл не перезаписывается), но правильнее было бы использовать applicationStorageDirectory или externalApplicationStorageDirectory, чтобы не увеличивать энтропию во вселенной.</p>




<p>Теперь мы можем добавлять пункты в список, и они точно никуда не денутся, потому что возможности удаления в программе пока не предусмотренно :) Но это легко исправить. Как лучше реализовать удаление пункта меню в нашем минималистичном интерфейсе? Сделать кнопку? Нет, так мне не нравится, лучше добавить возможность вывода меню по долгому нажатию на пункт списка. Пока что в этом меню будет только одна опция - "Delete", но впоследствии можно будет добавить туда что-нибудь еще.</p>




<p>Реализуем это с помощью директивы, которая будет ловить событие долгого нажатия. Я не писала ее сама, а взяла отсюда: <a href="https://gist.github.com/BobNisco/9885852" target="_blank">https://gist.github.com/BobNisco/9885852</a></p>




<figure class='code'><figcaption><span>controllers.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">shopList</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;shopList&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ngCordova&#39;</span><span class="p">,</span> <span class="s1">&#39;ngTouch&#39;</span><span class="p">]).</span>
</span><span class='line'><span class="nx">directive</span><span class="p">(</span><span class="s1">&#39;onLongPress&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$timeout</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">restrict</span><span class="o">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">link</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$elm</span><span class="p">,</span> <span class="nx">$attrs</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">$elm</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;touchstart&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                    <span class="c1">// Locally scoped variable that will keep track of the long press</span>
</span><span class='line'>                    <span class="nx">$scope</span><span class="p">.</span><span class="nx">longPress</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>                    <span class="c1">// We&#39;ll set a timeout for 600 ms for a long press</span>
</span><span class='line'>                    <span class="nx">$timeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>                        <span class="k">if</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">longPress</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                            <span class="c1">// If the touchend event hasn&#39;t fired,</span>
</span><span class='line'>                            <span class="c1">// apply the function given in on the element&#39;s on-long-press attribute</span>
</span><span class='line'>                            <span class="nx">$scope</span><span class="p">.</span><span class="nx">$apply</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>                                <span class="nx">$scope</span><span class="p">.</span><span class="nx">$eval</span><span class="p">(</span><span class="nx">$attrs</span><span class="p">.</span><span class="nx">onLongPress</span><span class="p">)</span>
</span><span class='line'>                            <span class="p">});</span>
</span><span class='line'>                        <span class="p">}</span>
</span><span class='line'>                    <span class="p">},</span> <span class="mi">600</span><span class="p">);</span>
</span><span class='line'>                <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>                <span class="nx">$elm</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;touchend&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                    <span class="c1">// Prevent the onLongPress event from firing</span>
</span><span class='line'>                    <span class="nx">$scope</span><span class="p">.</span><span class="nx">longPress</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>                    <span class="c1">// If there is an on-touch-end function attached to this element, apply it</span>
</span><span class='line'>                    <span class="k">if</span> <span class="p">(</span><span class="nx">$attrs</span><span class="p">.</span><span class="nx">onTouchEnd</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                        <span class="nx">$scope</span><span class="p">.</span><span class="nx">$apply</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>                            <span class="nx">$scope</span><span class="p">.</span><span class="nx">$eval</span><span class="p">(</span><span class="nx">$attrs</span><span class="p">.</span><span class="nx">onTouchEnd</span><span class="p">)</span>
</span><span class='line'>                        <span class="p">});</span>
</span><span class='line'>                    <span class="p">}</span>
</span><span class='line'>                <span class="p">});</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">};</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>




<p>Так же, как в примере, добавляем обработчик события:</p>




<figure class='code'><figcaption><span>controllers.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="nx">$scope</span><span class="p">.</span><span class="nx">itemOnLongPress</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">$scope</span><span class="p">.</span><span class="nx">items</span><span class="p">[</span><span class="nx">index</span><span class="p">].</span><span class="nx">menu</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>    <span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>




<p>С его помощью а также благодаря встроенной директиве ng-show в шаблоне можно изменять видимость контекстного меню для каждого пункта.</p>




<figure class='code'><figcaption><span>index.html</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;li</span> <span class="na">ng-repeat=</span><span class="s">&quot;item in items track by $index&quot;</span> <span class="na">on-long-press=</span><span class="s">&quot;itemOnLongPress($index)&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  {{item.name}}
</span><span class='line'>  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;item-menu&quot;</span> <span class="na">ng-show=</span><span class="s">&quot;item.menu&quot;</span> <span class="na">ng-init=</span><span class="s">&quot;item.menu = false&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;ul&gt;</span>
</span><span class='line'>          <span class="nt">&lt;li</span> <span class="na">ng-click=</span><span class="s">&quot;delete($index)&quot;</span><span class="nt">&gt;</span>Remove<span class="nt">&lt;/li&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/ul&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;/li&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<p>Внимательные могли заметить, что я уже добавила вызов функции delete, теперь надо написать саму эту функцию, которая будет удалять указанный объект из массива и перезаписывать файл. Параметр $index обозначает порядковый номер элемента в массиве, начиная с нуля.</p>




<figure class='code'><figcaption><span>controllers.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="nx">$scope</span><span class="p">.</span><span class="k">delete</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">$scope</span><span class="p">.</span><span class="nx">items</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">$scope</span><span class="p">.</span><span class="nx">writeFile</span><span class="p">();</span>
</span><span class='line'>    <span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>




<p>Ну вот, теперь можно и добавлять, и удалять записи списка. Но чего-то не хватает... Я думаю, нужно как-то маркировать статус записи - выполнено/не выполнено. Я использую для этого иконки из FontAwesome - icon-check для пункта, помеченного выполненным, и icon-check-empty для пустого чекбокса.</p>




<p>Меняем разметку:</p>




<figure class='code'><figcaption><span>index.html</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;li</span> <span class="na">ng-repeat=</span><span class="s">&quot;item in items track by $index&quot;</span> <span class="na">on-long-press=</span><span class="s">&quot;itemOnLongPress($index)&quot;</span> <span class="na">on-touch-end=</span><span class="s">&quot;itemOnTouchEnd($index)&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;i</span> <span class="na">ng-class=</span><span class="s">&quot;{&#39;icon-check-empty&#39;: !item.status, &#39;icon-check&#39;: item.status}&quot;</span> <span class="na">ng-click=</span><span class="s">&quot;changeStatus($index)&quot;</span><span class="nt">&gt;&lt;/i&gt;</span>
</span><span class='line'>  
</span><span class='line'>...
</span><span class='line'><span class="nt">&lt;/li&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<p>И добавляем функцию для переключения статуса:</p>




<figure class='code'><figcaption><span>controllers.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>    <span class="nx">$scope</span><span class="p">.</span><span class="nx">changeStatus</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">$scope</span><span class="p">.</span><span class="nx">items</span><span class="p">[</span><span class="nx">index</span><span class="p">].</span><span class="nx">status</span> <span class="o">=</span> <span class="o">!</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">items</span><span class="p">[</span><span class="nx">index</span><span class="p">].</span><span class="nx">status</span><span class="p">;</span>
</span><span class='line'>        <span class="nx">$scope</span><span class="p">.</span><span class="nx">writeFile</span><span class="p">();</span>
</span><span class='line'>    <span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>Теперь сделанные дела и купленные продукты можно пометить галочкой, все как у тру-девелоперов, хаха :) </p>




<p>Итак, у нас есть законченное приложение, которое выполняет свои функции, и ушло на его создание всего несколько часов (вкуривание документации в эти часы тоже входит). Писала пост об этом я гораздо дольше, чем делала само приложение! </p>




<p>Теперь можно подключить свой телефон, включить отладку по USB, установить приложение и наслаждаться своим могуществом)</p>




<p>Полный код здесь: <a href="https://github.com/rthewheel/shopList/" target="_blank">https://github.com/rthewheel/shopList/</a>

Но он, возможно, будет изменяться.</p>



</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Написала <span class="fn">Ann R</span></span>

      




<time class='entry-date' datetime='2016-01-06T10:50:21+02:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>6</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>10:50 am</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/android/'>android</a>, <a class='category' href='/blog/categories/angularjs/'>angularjs</a>, <a class='category' href='/blog/categories/cordova/'>cordova</a>, <a class='category' href='/blog/categories/mobile/'>mobile</a>, <a class='category' href='/blog/categories/nodejs/'>nodejs</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <div class="twitter">
    <a href="//twitter.com/share" class="twitter-share-button" data-url="http://nim-f.github.io/blog/2016/01/06/make-simple-mobile-app-with-cordova-and-angularjs/" data-via="" data-counturl="http://nim-f.github.io/blog/2016/01/06/make-simple-mobile-app-with-cordova-and-angularjs/" >Tweet</a>
  </div>
  
  
  
  <div class="fb-share-button" data-href="https://developers.facebook.com/docs/plugins/" data-layout="button_count"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2016/01/01/webkit-extra-pixels/" title="Previous Post: Webkit, transform и лишние пиксели ">&laquo; Webkit, transform и лишние пиксели </a>
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Комментарии</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Свежее</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/01/06/make-simple-mobile-app-with-cordova-and-angularjs/">Как сделать простое мобильное приложение с помощью Apache Cordova и AngularJS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/01/01/webkit-extra-pixels/">Webkit, Transform и лишние пиксели</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/12/27/initial-post/">Первый пост!</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Ann R -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'rthewheel';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://nim-f.github.io/blog/2016/01/06/make-simple-mobile-app-with-cordova-and-angularjs/';
        var disqus_url = 'http://nim-f.github.io/blog/2016/01/06/make-simple-mobile-app-with-cordova-and-angularjs/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/ru_RU/sdk.js#xfbml=1&version=v2.5";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
